//
   Created by hr on 2016/9/22.

extends ../layout
block content
   div.container
      
      div.row
         script(src="/javascripts/pages/user.js" type="text/javascript")
         div(class="col-md-2")
            div.row
                a(class="btn glyphicon glyphicon-user col-md-4 col-md-offset-2" id="dropdownMenu1" style="font-size: 100px;color: grey;")
            div.row
                p(class="col-md-4 col-md-offset-4" style="margin-top:-20px;") lijie
            ul(class="row nav nav-tabs nav-stacked" style="margin-top:20px" data-offset-top="125")
                li( class="active")
                    a( href="#countinfo") 账户信息
                li()
                    a( href="#myInfo") 我的资料
                li()
                    a( href="#myWorks") 我的作品
                li()
                    a( href="#") 信箱
                li()
                    a( href="#myLearningCurve") 我的学习曲线
         div(class="col-md-10")
            div(id="countinfo")
                div(class="page-header col-md-12")
                    h1 账户信息
                div(class="col-md-12")
                    - if('#{me.loginnameqz}'==undefined)
                            p 没有找到账户信息
                        - else
                            div.row
                                div(class="col-md-2")
                                    登录名：
                                div(class="col-md-10")
                                    p #{me.loginname}
                            div.row
                                div(class="col-md-2")
                                    用户名：
                                div(class="col-md-10")
                                    p #{me.name}
                            div.row
                                div(class="col-md-2")
                                    注册时间：
                                div(class="col-md-10")
                                    p #{me.create_at}
                            div.row
                                div(class="col-md-2")
                                    积分：
                                div(class="col-md-10")
                                    p #{me.score}
                            div.row
                                div(class="col-md-2")
                                    注册邮箱：
                                div(class="col-md-10")
                                    p #{me.email}
            div(id="myInfo")      
                div(class="page-header col-md-12")
                    h1 我的资料
                div(class="col-md-8")
                    div(class="input-group")
                        span(class="input-group-addon") 姓名
                        input#nameText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.name)
                    div(class="input-group")
                        span(class="input-group-addon") 性别
                        - if(me.UserInfo.sex==0 )
                            input#sexText(type="text" class="form-control" placeholder="twitterhandle" value="男")
                        - else 
                            input#sexText(type="text" class="form-control" placeholder="twitterhandle" value="女")
                    div(class="input-group")
                        span(class="input-group-addon") 生日
                        input#birthText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.birth)
                    div(class="input-group")
                        span(class="input-group-addon") 学校
                        input#schoolText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.school)
                    div(class="input-group")
                        span(class="input-group-addon") 年级
                        input#greadText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.gread)
                    div(class="input-group")
                        span(class="input-group-addon") 省份
                        input#provinceText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.province)
                    div(class="input-group")
                        span(class="input-group-addon") 城市
                        input#cityText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.city)
                    div(class="input-group")
                        span(class="input-group-addon") 地址
                        input#addressText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.address)
                    div(class="input-group")
                        span(class="input-group-addon") 年龄
                        input#ageText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.age)
                    div(class="input-group")
                        span(class="input-group-addon") 联系电话
                        input#phoneText(type="text" class="form-control" placeholder="twitterhandle" value=me.UserInfo.phoneNumber)
                    div(style="margin-top:15px")
                        button#updateUserInfoBtn(class="btn" style="display:block;margin-left:auto;margin-right:auto") 更新资料
            div(id="myWorks")
                div(class="page-header col-md-12" )
                    h1 我的作品
                div(class="col-md-12")
                    - for(var i=0; i<myworks.length;i=i+4)
                        div.row
                                div(class="col-md-4" style="margin-bottom:20px")
                                    div(style="background:write")
                                        div
                                            a(href='/works/'+myworks[i]._id)
                                                img(src="/thumbnail/"+ "#{myworks[i]._id}"+".png" style="max-width:100%" alt="image1")
                                        div
                                            a(href='/works/'+myworks[i]._id)
                                                h3 #{myworks[i].name}
                                            div(class="row")
                                                span 
                                                    p 浏览次数： #{myworks[i].upCount}
                                - if((i+1)<myworks.length)
                                    div(class="col-md-4" style="margin-bottom:20px")
                                        div(style="background:write")
                                            div
                                                a(href='/works/'+myworks[i+1]._id)
                                                    img(src="/thumbnail/"+ "#{myworks[i+1]._id}"+".png" style="max-width:100%" alt="image1")
                                            div
                                                a(href='/works/'+myworks[i+1]._id)
                                                    h3 #{myworks[i+1].name}
                                                div(class="row")
                                                    span 
                                                        p 浏览次数： #{myworks[i+1].upCount}
                                - if((i+2)<myworks.length)
                                    div(class="col-md-4" style="margin-bottom:20px")
                                        div(style="background:write")
                                            div
                                                a(href='/works/'+myworks[i+2]._id)
                                                    img(src="/thumbnail/"+ "#{myworks[i+2]._id}"+".png" style="max-width:100%" alt="image1")
                                            div
                                                a(href='/works/'+myworks[i+2]._id)
                                                    h3 #{myworks[i+2].name}
                                                div(class="row")
                                                    span 
                                                        p 浏览次数： #{myworks[i+2].upCount}
                                
            div(id="myLearningCurve")
                div(class="page-header col-md-12")
                    h1 我的学习曲线
                          #curvecontainer
                          script(src='/javascripts/dist/Chart.bundle.js')
                          script(src='/javascripts/dist/utils.js')
                          style.
                            canvas{
                            -moz-user-select: none;
                            -webkit-user-select: none;
                            -ms-user-select: none;
                            }
                            .chart-container {
                            width: 500px;
                            margin-left: 40px;
                            margin-right: 40px;
                            margin-bottom: 40px;
                            }
                        script.
                          var randomScalingFactor = function() {
                          return Math.round(Math.random() * 100);
                          };
                          function createConfig(pointStyle, title) {
                          return {
                          type: 'line',
                          data: {
                          labels: ["January", "February", "March", "April", "May", "June", "July"],
                          datasets: [{
                          label: "成绩",
                          backgroundColor: window.chartColors.red,
                          borderColor: window.chartColors.red,
                          data: [randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor(), randomScalingFactor()],
                          fill: false,
                          pointRadius: 10,
                          pointHoverRadius: 15,
                          showLine: true // no line shown
                          }]
                          },
                          options: {
                          responsive: true,
                          title:{
                          display:true,
                          text: title
                          },
                          legend: {
                          display: false
                          },
                          elements: {
                          point: {
                          pointStyle: pointStyle
                          }
                          }
                          }
                          };
                          }
                          window.onload = function() {
                          strOfCanvas = ['正确性', '性能','简洁度','变量名','布局','配色','声音'];
                          var crcontainer = document.querySelector('#curvecontainer');
                          var paint = function(pointStyle, title) {
                          var div = document.createElement('div');
                          div.classList.add('chart-container');
                          var canvas = document.createElement('canvas');
                          div.appendChild(canvas);
                          crcontainer.appendChild(div);
                          var ctx = canvas.getContext('2d');
                          var config = createConfig(pointStyle, title);
                          new Chart(ctx, config);
                          }
                          pointStyle = [
                          'circle',
                          'triangle',
                          'rect',
                          'rectRounded',
                          'rectRot',
                          'cross',
                          'crossRot',
                          'star',
                          'line',
                          'dash'
                          ];
                          for (var i = 0; i < 7; i++ ){
                          paint(pointStyle[i], strOfCanvas[i]);
                          }
                          };
